{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "version": "1.1.0",
  "project": {
    "name": "Arrow Block 3D",
    "description": "3D puzzle game with themeable visual assets"
  },
  "output": {
    "themeFolder": "public/assets/{themeName}/",
    "tempFolder": "temp/{themeName}/",
    "configFile": "src/config/GameConfig.ts",
    "configUpdatePattern": "CURRENT_THEME: '{themeName}'",
    "cleanupTempFolder": true
  },
  "constraints": {
    "totalBundleSize": "5MB",
    "totalAssetBudget": "400KB",
    "encoding": "Base64",
    "encodingOverhead": 1.33,
    "notes": "HTML5 playable ad with assets inlined as Base64"
  },
  "postProcessing": {
    "resizeHelper": ".skills/tech-artist-generate-asset/image-resize-helper.py",
    "resizeStrategy": {
      "icons": "contain-centered",
      "textures": "cover-crop",
      "backgrounds": "cover-crop"
    }
  },
  "referenceAssets": {
    "_comment": "Reference assets used as image_prompt for style transfer. Paths are relative to project root.",
    "reference-logo": "public/assets/wood/logo.png"
  },
  "assetTypes": {
    "_comment": "Model-specific parameters: Nano Banana (aspect_ratio presets only: 1:1, 9:16, 2:3, 3:2, 3:4, 4:3, 4:5, 5:4, 16:9, 21:9, etc. + output_format: jpg/png, no custom width/height or resolution parameter). Post-processing resize handles final dimensions.",
    "block-texture": {
      "filename": "block-texture.jpg",
      "dimensions": { "width": 512, "height": 512 },
      "format": "JPEG",
      "sizeTarget": "150KB",
      "model": "google/nano-banana",
      "modelVersion": "google/nano-banana",
      "modelParameters": {
        "aspect_ratio": "1:1",
        "output_format": "jpg"
      },
      "critical": "SEAMLESS TILEABLE + UNIFORM SCALE (wraps on all 4 edges without visible seams, looks good when stretched non-uniformly)",
      "usage": "Applied as material to all block faces in the 3D scene - may be stretched on non-square faces",
      "postProcessing": [
        "Resize to exact dimensions (cover-crop)",
        "JPEG compression (quality 85%)"
      ],
      "styleReference": null,
      "promptTemplate": "Create a seamless, tileable texture for a 3D cube surface.\n\nREQUIREMENTS:\n- Perfectly seamless edges (wraps on all sides)\n- UNIFORM pattern that looks good even when stretched non-uniformly\n- Avoid directional patterns or elements that look distorted when scaled\n- Flat, simple style (not overly detailed)\n- Square 512x512\n\nSTYLE: {THEME_DESCRIPTION}\n\nNEGATIVE PROMPT: borders, frames, text, watermarks, seams, edges, photorealistic, complex details, busy patterns, directional elements, perspective lines",
      "critiquePrompt": "Analyze this texture that will be used on 3D cube faces:\n1. Are the edges seamless? (Check all 4 edges - can it tile without visible seams?)\n2. Does it match the \"{THEME_NAME}\" theme aesthetic?\n3. Is there appropriate visual interest without being overwhelming?\n4. Would this look acceptable if stretched non-uniformly (e.g., 1:2 ratio)? Avoid strong directional patterns.\n5. Are there any obvious artifacts, text, or watermarks?\n\nRespond with PASS or FAIL and specific reasons.",
      "qualityChecklist": [
        "All 4 edges are seamless (test by tiling 2x2)",
        "Visual interest without overwhelming detail",
        "Works when viewed from multiple angles",
        "Looks acceptable when stretched non-uniformly",
        "No strong directional patterns that distort when scaled",
        "Appropriate contrast for arrow visibility",
        "Matches theme aesthetic"
      ]
    },
    "arrow-icon": {
      "filename": "arrow-icon.png",
      "dimensions": { "width": 256, "height": 256 },
      "format": "PNG",
      "sizeTarget": "20KB",
      "model": "google/nano-banana",
      "modelVersion": "google/nano-banana",
      "modelParameters": {
        "aspect_ratio": "1:1",
        "output_format": "png"
      },
      "critical": "Points upward, transparent background, simple flat design, CENTERED in frame, SOLID BLACK for engine tinting",
      "usage": "Displayed on block faces to indicate pull direction (tinted by Babylon.js with arrowColor from palette)",
      "postProcessing": [
        "Background removal (cjwbw/rembg)",
        "Threshold to pure black (convert non-transparent to #000000 for clean tinting)",
        "Alpha erosion (1px)",
        "Center in frame (contain-centered)",
        "Resize to exact dimensions",
        "PNG compression (level 9)"
      ],
      "styleReference": null,
      "promptTemplate": "{THEME_NAME} styled arrow icon pointing straight UP. Simple geometric shape. Solid BLACK silhouette. Sharp edges. Flat vector graphic. Minimal design. White background. No colors, no gradients, pure black shape only.",
      "critiquePrompt": "Analyze this arrow icon for a game:\n1. Does it clearly point UPWARD?\n2. Is the arrow CENTERED in the frame (equal padding on all sides)?\n3. Is it on a solid white background (not transparent, not checkerboard)?\n4. Is it a SOLID BLACK SHAPE (flat, no gradients, no outlines)?\n5. Is it MINIMAL and simple (no environmental elements, no 3D effects)?\n6. Are there NO shadows (no ground shadows, drop shadows, or 3D depth)?\n7. Are there NO gradients or shading effects?\n8. Does it look like a flat die-cut sticker (2D, not 3D)?\n9. Is it simple and readable at small sizes?\n10. CRITICAL: Check for 'grounding' - does the icon have a shadow underneath, platform, or look like it's sitting on a surface? If YES, this is a FAIL.\n\nRespond with PASS or FAIL and specific reasons.",
      "qualityChecklist": [
        "Clearly points UPWARD (will be rotated for other directions)",
        "CENTERED in the frame with equal padding on all sides",
        "Solid black on white background (for clean rembg + threshold conversion)",
        "Simple, bold design (readable at 64x64 pixels)",
        "Flat 2D die-cut sticker style (no 3D, no grounding)",
        "No shadows, gradients, or depth effects"
      ]
    },
    "background": {
      "filename": "background.jpg",
      "dimensions": { "width": 768, "height": 1344 },
      "format": "JPEG",
      "sizeTarget": "100KB",
      "model": "google/nano-banana",
      "modelVersion": "google/nano-banana",
      "modelParameters": {
        "aspect_ratio": "9:16",
        "output_format": "jpg"
      },
      "critical": "Non-distracting, suitable for UI overlay",
      "usage": "Full-screen background behind the 3D scene and UI",
      "postProcessing": [
        "Resize to exact dimensions (cover-crop, no stretching)",
        "JPEG compression (quality 85%)"
      ],
      "styleReference": {
        "asset": "block-texture",
        "promptStrength": 0.7,
        "rationale": "Ensures background atmosphere matches material style"
      },
      "promptTemplate": "Create an atmospheric background for a puzzle game.\n\nREQUIREMENTS:\n- Non-distracting, simple gradient or blur\n- Flat, minimal style\n- Portrait orientation 768x1344\n\nSTYLE: {THEME_DESCRIPTION}\n\nNEGATIVE PROMPT: detailed foreground, busy patterns, complex elements, photorealistic, text, UI elements, characters",
      "critiquePrompt": "Analyze this background image for a puzzle game:\n1. Is it non-distracting (could you comfortably place UI and game elements on top)?\n2. Does it match the \"{THEME_NAME}\" theme?\n3. Are there any focal points that would compete for attention?\n4. Is the color palette appropriate?\n\nRespond with PASS or FAIL and specific reasons.",
      "qualityChecklist": [
        "Non-distracting (blurred, gradient, or atmospheric)",
        "Appropriate color palette matches theme",
        "No focal points that compete with game elements",
        "UI text and icons remain readable when overlaid",
        "Matches theme aesthetic"
      ]
    },
    "lock-overlay": {
      "filename": "lock-overlay.png",
      "dimensions": { "width": 512, "height": 512 },
      "format": "PNG",
      "sizeTarget": "50KB",
      "model": "google/nano-banana",
      "modelVersion": "google/nano-banana",
      "modelParameters": {
        "aspect_ratio": "1:1",
        "output_format": "png"
      },
      "critical": "Clear 'locked' symbolism, FULLY transparent background (no white inside), CENTERED, LARGE and PROMINENT",
      "usage": "Overlaid on locked blocks to indicate they cannot be removed",
      "postProcessing": [
        "Background removal (cjwbw/rembg)",
        "White color removal (threshold 240)",
        "Alpha erosion (2px)",
        "Resize to exact dimensions (contain-centered, no additional centering step)",
        "PNG compression (level 9)"
      ],
      "styleReference": {
        "asset": "block-texture",
        "promptStrength": 0.7,
        "rationale": "Ensures overlay material matches block material style"
      },
      "promptTemplate": "{THEME_NAME} styled padlock icon. EXTREMELY LARGE filling 85-90% of the frame edge-to-edge. Solid colors. Sharp edges. Flat vector graphic. Minimal design. White background. Centered. The padlock should nearly touch all edges of the frame.",
      "critiquePrompt": "Analyze this lock/chain overlay icon:\n1. Is the 'locked' symbolism immediately clear?\n2. Is the background FULLY transparent with NO white or light gray areas inside the icon?\n3. Is the icon CENTERED in the frame?\n4. CRITICAL SIZE CHECK: Does the icon fill at least 80-90% of the frame? Is the padlock LARGE and PROMINENT, nearly touching the edges? If the icon is small with lots of white space around it, this is a FAIL.\n5. Is it MINIMAL (just the lock icon floating, no environmental elements, circuit boards, chains, or busy backgrounds)?\n6. Are there NO shadows (no ground shadows, drop shadows, cast shadows, or 3D depth)?\n7. Are there NO platforms, pedestals, or base elements underneath the lock?\n8. Are there NO decorative extensions (circuit lines, wires, cables) coming out of the lock?\n9. Does it match the \"{THEME_NAME}\" theme?\n10. Will it be visible when overlaid on various block textures?\n\nRespond with PASS or FAIL and specific reasons. FAIL if there is ANY white or near-white color remaining, ANY shadows, or if the SIZE is too small with excessive padding.",
      "qualityChecklist": [
        "Immediately recognizable as lock/chain/barrier",
        "FULLY transparent background (no white halos or fills)",
        "NO white or near-white colors inside the icon",
        "CENTERED in the frame",
        "LARGE SIZE: Fills 80-90% of frame with minimal white space",
        "Visible when overlaid on various block textures",
        "Matches theme aesthetic",
        "Sufficient contrast with block materials"
      ]
    },
    "currency-icon": {
      "filename": "currency-icon.png",
      "dimensions": { "width": 128, "height": 128 },
      "format": "PNG",
      "sizeTarget": "20KB",
      "model": "google/nano-banana",
      "modelVersion": "google/nano-banana",
      "modelParameters": {
        "aspect_ratio": "1:1",
        "output_format": "png"
      },
      "critical": "Simple, iconic, readable at small sizes, CENTERED in frame, flat vector style, LARGE and PROMINENT",
      "usage": "Coin/currency indicator in header",
      "postProcessing": [
        "Background removal (cjwbw/rembg)",
        "Alpha erosion (1px)",
        "Center in frame (contain-centered, padding: 0.03)",
        "Resize to exact dimensions",
        "PNG compression (level 9)"
      ],
      "styleReference": null,
      "promptTemplate": "{THEME_NAME} styled money bills icon. EXTREMELY LARGE filling 90-95% of the frame edge-to-edge. Simple geometric shape. Solid colors. Sharp edges. Flat vector graphic. Minimal design. White background. Centered. The bills should nearly touch all edges of the frame.",
      "critiquePrompt": "Analyze this currency icon:\n1. Is it simple and readable at small sizes?\n2. Is the icon CENTERED in the frame?\n3. CRITICAL SIZE CHECK: Does the icon fill at least 85-90% of the frame? Are the bills LARGE and PROMINENT, nearly touching the edges? If the icon is small with lots of white space around it, this is a FAIL.\n4. Is it on a solid white background (not transparent, not checkerboard)?\n5. Is it a flat 2D vector style (die-cut sticker aesthetic)?\n6. Are there NO shadows of any kind (no ground shadows, drop shadows, or 3D depth)?\n7. Are there NO environmental elements (no scene, bokeh, platform)?\n8. Does it match the \"{THEME_NAME}\" theme aesthetic?\n9. Is the currency symbolism clear?\n10. CRITICAL: Check for 'grounding' - does it look like it's sitting on a surface? If YES, FAIL.\n\nRespond with PASS or FAIL and specific reasons. SIZE is critical - small icons with excessive padding are a FAIL.",
      "qualityChecklist": [
        "Simple, iconic design (readable at small sizes)",
        "CENTERED in the frame",
        "LARGE SIZE: Fills 85-95% of frame with minimal white space",
        "Solid white background (for clean rembg processing)",
        "Flat 2D vector style (no 3D, no grounding)",
        "Matches theme aesthetic",
        "Clear currency symbolism"
      ]
    },
    "logo": {
      "filename": "logo.png",
      "dimensions": { "width": 128, "height": 128 },
      "format": "PNG",
      "sizeTarget": "20KB",
      "model": "google/nano-banana",
      "modelVersion": "google/nano-banana",
      "modelParameters": {
        "aspect_ratio": "1:1",
        "output_format": "png"
      },
      "critical": "Simple, iconic, readable at small sizes, CENTERED in frame, based on reference logo, flat style",
      "usage": "Game logo/branding (favicon)",
      "postProcessing": [
        "Background removal (cjwbw/rembg)",
        "Alpha erosion (1px)",
        "Center in frame (contain-centered)",
        "Resize to exact dimensions",
        "PNG compression (level 9)"
      ],
      "styleReference": {
        "asset": "reference-logo",
        "promptStrength": 0.6,
        "rationale": "Maintain recognizable logo structure while adapting theme aesthetics"
      },
      "promptTemplate": "{THEME_NAME} styled cube with arrows logo icon. Simple geometric shape. Solid colors. Sharp edges. Flat vector graphic. Minimal design. White background. Centered.",
      "critiquePrompt": "Analyze this logo icon:\n1. Is it simple and readable at small sizes?\n2. Is the icon CENTERED in the frame?\n3. Is it on a solid white background (not transparent, not checkerboard)?\n4. Does the cube appear to float (no ground, platform, or base underneath)?\n5. Are there NO shadows of any kind (no ground shadows, drop shadows, reflections)?\n6. Is it a flat vector style (not a photorealistic 3D render)?\n7. Does it maintain recognizable elements from the reference logo (cube + arrows)?\n8. Does it match the \"{THEME_NAME}\" theme aesthetic?\n9. Is it memorable and distinctive?\n10. CRITICAL: Check for 'grounding' - does it look like it's sitting on a surface? If YES, FAIL.\n\nRespond with PASS or FAIL and specific reasons.",
      "qualityChecklist": [
        "Simple, iconic design (readable at small sizes)",
        "CENTERED in the frame",
        "Solid white background (for clean rembg processing)",
        "Flat vector style (no photorealistic 3D, no grounding)",
        "Recognizable logo elements (cube + arrows)",
        "Matches theme aesthetic"
      ]
    }
  },
  "palette": {
    "filename": "palette.json",
    "visionBased": true,
    "schema": {
      "name": "string (theme name)",
      "version": "string (1.0.0)",
      "babylon": {
        "blockDefault": "number[3] (RGB normalized 0-1)",
        "arrowColor": "number[3] (RGB normalized 0-1) - MUST contrast with block texture",
        "keyArrowColor": "number[3] (RGB normalized 0-1 - dark color for key block arrows)",
        "lockedArrowColor": "number[3] (RGB normalized 0-1 - color for locked block arrows)",
        "background": "number[4] (RGBA normalized 0-1)",
        "keyColor": "number[3] (RGB normalized 0-1)",
        "keyEmissive": "number[3] (RGB normalized 0-1)",
        "lockedColor": "number[3] (RGB normalized 0-1)"
      },
      "css": {
        "headerBg": "string (hex color)",
        "currencyContainer": "string (hex color)",
        "currencyPill": "string (hex color) - pill background in overlay",
        "bgBlue": "string (hex color) - primary UI accent",
        "darkBlue": "string (hex color) - dark UI variant",
        "accent": "string (hex color) - overlay border and highlights (theme-specific, e.g., gold, pink, cyan)",
        "accentDark": "string (hex color) - darker variant of accent",
        "buttonPrimary": "string (hex color) - primary button color (e.g., green for success)",
        "buttonPrimaryDark": "string (hex color) - primary button dark variant",
        "buttonSecondary": "string (hex color) - secondary button color (can match primary or be different)",
        "buttonSecondaryDark": "string (hex color) - secondary button dark variant"
      }
    },
    "extractionStrategy": {
      "blockTexture": {
        "prompt": "Analyze this seamless texture for a \"{themeName}\" themed game.\nTheme description: {themeDescription}\n\nExtract the color palette that would work best for:\n1. Block default color (most representative base color)\n2. Background scene color (darkest, atmospheric tone)\n3. Arrow indicator color (MUST CONTRAST STRONGLY with the texture - pick a color that will be clearly visible on this texture)\n4. Locked block color (desaturated, muted variant)\n5. Locked arrow color (should be visible on the locked block color)\n\nIMPORTANT: The arrow color must be highly visible against the texture. If the texture is dark, use a bright color. If it has neon elements, pick a complementary bright color.\n\nConsider the overall aesthetic and ensure colors are harmonious.\n\nReturn RGB values (0-255) as JSON:\n{\n  \"blockDefault\": [r, g, b],\n  \"background\": [r, g, b, a],\n  \"arrowColor\": [r, g, b],\n  \"lockedColor\": [r, g, b],\n  \"lockedArrowColor\": [r, g, b]\n}"
      },
      "lockOverlay": {
        "prompt": "Analyze this lock overlay icon for a \"{themeName}\" themed game.\n\nFind the single BRIGHTEST, most SATURATED, most VISUALLY IMPACTFUL color.\n\nThis color will be used for:\n- Key block color (the goal block players must reach)\n- Emissive glow effect (needs maximum visual hierarchy and pop)\n\nChoose the color that would create the strongest visual contrast and immediately draw the player's eye.\n\nReturn the single best color as JSON:\n{\n  \"keyColor\": [r, g, b],\n  \"reasoning\": \"why this color creates maximum visual impact\"\n}"
      },
      "cssColors": {
        "prompt": "Based on these \"{themeName}\" themed assets, suggest CSS hex colors for the UI:\n\n1. headerBg - Header background (dark, matches theme)\n2. currencyContainer - Currency display background (slightly darker than header)\n3. currencyPill - Currency pill in overlay (dark background for white text)\n4. bgBlue - Primary UI background accent\n5. darkBlue - Dark UI variant\n6. accent - Theme accent color for borders and highlights (NOT always gold - match theme: cyberpunk=neon pink/cyan, medieval=gold, nature=green, etc.)\n7. accentDark - Darker variant of accent\n8. buttonPrimary - Primary button color (success/action - can be green or theme-appropriate)\n9. buttonPrimaryDark - Primary button shadow/dark variant\n10. buttonSecondary - Secondary button color (can match primary or complement it)\n11. buttonSecondaryDark - Secondary button shadow\n\nIMPORTANT: The 'accent' color should match the theme aesthetic, NOT default to gold. For cyberpunk, use neon colors. For nature, use greens. For medieval, use gold.\n\nEnsure harmony with {themeName} aesthetic and good UI readability.\n\nReturn as JSON:\n{\n  \"headerBg\": \"#hex\",\n  \"currencyContainer\": \"#hex\",\n  \"currencyPill\": \"#hex\",\n  \"bgBlue\": \"#hex\",\n  \"darkBlue\": \"#hex\",\n  \"accent\": \"#hex\",\n  \"accentDark\": \"#hex\",\n  \"buttonPrimary\": \"#hex\",\n  \"buttonPrimaryDark\": \"#hex\",\n  \"buttonSecondary\": \"#hex\",\n  \"buttonSecondaryDark\": \"#hex\"\n}"
      }
    }
  },
  "commonAssets": {
    "_comment": "Theme-independent assets shared across all themes. These are NOT generated and should NOT be included in theme folders.",
    "piggy-bank": {
      "path": "public/assets/common/icons/piggy-bank.png",
      "usage": "Victory screen icon - displayed with CSS filter: brightness(0) invert(1)",
      "rationale": "Single common piggy bank silhouette used for all themes since it's CSS-inverted to solid white"
    }
  },
  "workflow": {
    "generationOrder": [
      "block-texture",
      "background",
      "lock-overlay",
      "arrow-icon",
      "currency-icon",
      "logo"
    ],
    "heroAsset": "block-texture",
    "maxIterations": 3,
    "validation": {
      "fileSize": true,
      "dimensions": true,
      "format": true,
      "transparency": true,
      "visionCritique": true,
      "centering": true,
      "whiteRemoval": true
    },
    "postGeneration": {
      "resizeAllAssets": true,
      "cleanupTempFolder": true
    }
  },
  "dependencies": {
    "replicateMCP": {
      "required": true,
      "configFile": ".mcp.json"
    },
    "postProcessingScript": {
      "required": false,
      "scriptPath": ".skills/tech-artist-generate-asset/post-process.py",
      "fallback": "Use Pillow library directly"
    },
    "resizeHelper": {
      "required": true,
      "scriptPath": ".skills/tech-artist-generate-asset/image-resize-helper.py",
      "fallback": "Use Pillow library with manual resize commands"
    },
    "colorExtractionScript": {
      "required": false,
      "scriptPath": ".skills/tech-artist-reskin/extract-colors.py",
      "fallback": "Use vision-based extraction"
    }
  }
}
